parallel (
    "nxp-node3" : 
    { 
    
        node('NXP_Ubuntu_16.04_64bit_Node3') 
        {
	    sh 'echo we are running in master job and pwd is $PWD'
	    sh 'rm -rf test-jenkinfile-ci'
            sh 'git clone git@github.com:ydasar/test-jenkinfile-ci.git'
            sh 'test-jenkinfile-ci/scripts/build/projects/build-nxp-products.sh Delete_TemporaryFiles imx6slevk'
               
            stage('imx6slevk')
            {
                status = build(job: 'NXP-imx6slevk-pipeline', propagate: false).result
                if(status == 'FAILURE')
                {
                    currentBuild.result = 'UNSTABLE' // of FAILURE
                }
            }
        }
    },

    "nxp-node1" : 
    { 

        node('NXP_Ubuntu_16.04_64bit_Node1') 
        {
	    sh 'echo we are running in master job and pwd is $PWD'
	    sh 'rm -rf test-jenkinfile-ci'
            sh 'git clone git@github.com:ydasar/test-jenkinfile-ci.git'
            sh 'test-jenkinfile-ci/scripts/build/projects/build-nxp-products.sh Delete_TemporaryFiles imx6ulevk'
            stage('imx6ulevk')
            {
                status = build(job: 'NXP-imx6ulevk-pipeline', propagate: false).result
                if(status == 'FAILURE')
                {
                    currentBuild.result = 'UNSTABLE' // of FAILURE
                }
            }
            sh 'test-jenkinfile-ci/scripts/build/projects/build-nxp-products.sh consolidate_env_variables imx6ulevk'
        }


    }
)
          
          
node('NXP_Ubuntu_16.04_64bit_Node3') 
{
    stage('Notify')
    {
        status = build(job: 'NXP-email-pipeline', parameters: [[$class: 'StringParameterValue', name: 'export_nxp_node3', value: '/tmp/nxp-all-products-export']], propagate: false).result
        if(status == 'FAILURE')
        {
            currentBuild.result = 'UNSTABLE' // of FAILURE
        }
    }
}
